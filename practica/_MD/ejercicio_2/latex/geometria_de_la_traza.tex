\documentclass{article}
\usepackage[spanish]{babel}
\usepackage[hidelinks]{hyperref}
\usepackage{mathtools}
\usepackage{amssymb}
\usepackage{amsthm}

\newcommand{\realNumbers}{\mathbb{R}}
\DeclarePairedDelimiterX{\norm}[1]{\lVert}{\rVert}{#1}

\usepackage{bm}
\newcommand{\uvec}[1]{\boldsymbol{\hat{\textbf{#1}}}}

\newtheorem{lemma}{Lema}
\newtheorem{physicalLaw}{Ley}
\newtheorem{theorem}{Teorema}

\title{Geometría de la traza del movimiento de un electron expuesto a un campo electromagnético externo}
\author{Pablo Brianese}
\begin{document}
  \maketitle
  % \begin{abstract}
  %   Un resumen porque quedó largo y difícil de leer.
  % \end{abstract}
  \begin{physicalLaw}
    La ecuación del movimiento para una partícula de masa \(m\), carga \(q\), expuesta a un campo electromagnético externo es
    \begin{align}
      \label{equation:movementOfChargedParticleExposedToElectromagneticField}
      m \vec{a}
      =
      q \vec{E} + q \vec{v} \times \vec{B}
    \end{align}
    En unidades SI.
  \end{physicalLaw}

  Si derivamos esta ley con respecto al tiempo, asumiendo que los campos eléctrico y magnético son constantes, obtenemos una ecuación para la aceleración
  \begin{align}
    \label{equation:accelerationOfChargedParticleExposedToElectromagneticField}
    m \vec{j} = q \vec{a} \times \vec{B}
  \end{align}
  donde \(\vec{j} = d \vec{a} / d t\) es la llamada sobreaceleración de la partícula.
  Para resolver esta ecuación suponemos además que ambos \(\vec{E}\), \(\vec{B}\) son nonulos.

  \begin{theorem}
    \label{theorem:acceleration_dot_magneticFieldIsConstant}
    El producto punto, \(\vec{a} \cdot \vec{B}\), es constante.
  \end{theorem}
  \begin{proof}
    Partimos de la ecuación \(m \vec{j} = q \vec{a} \times \vec{B}\).
    Multiplicamos por el campo magnético para obtener \(m \vec{j} \cdot \vec{B} = q \vec{a} \times \vec{B} \cdot \vec{B}\).
    Porque el producto cruz \(\vec{v} \times \vec{B}\) es ortogonal a \(\vec{B}\), el lado derecho de la ecuación es nulo.
    Resulta \(\vec{j} \cdot \vec{B} = 0\).
    Pero el producto punto es lineal, luego conmuta con la derivación.
    Por lo tanto \(\frac{d}{d t} (\vec{a} \cdot \vec{B}) = 0\).
  \end{proof}

  \begin{theorem}
    \label{theorem:modulusOfAccelerationIsConstant}
    El módulo de la aceleración, \(a\), es constante.
  \end{theorem}
  \begin{proof}
    Partimos de la ecuación \(m \vec{j} = q \vec{a} \times \vec{B}\).
    Multiplicamos por la aceleración para obtener \(m \vec{j} \cdot \vec{a} = q (\vec{a} \times \vec{B}) \cdot \vec{a}\).
    Porque el producto cruz \(\vec{a} \times \vec{B}\) es ortogonal a \(\vec{a}\), el lado derecho de la ecuación es nulo.
    Resulta \(\vec{j} \cdot \vec{a} = 0\).
    Esto nos permite calcular \(\frac{d}{d t} a^2 = 2 \vec{a} \cdot \frac{d \vec{a}}{d t} = 2 \vec{a} \cdot \vec{j} = 0\).
  \end{proof}

  Fijemos una base ortonormal \(\{\bar{b}_1, \bar{b}_2\}\) del plano ortogonal a \(\vec{B}\).
  Esto nos permite definir dos escalares \(\alpha = \vec{a} \cdot \bar{b}_1\), \(\beta = \vec{a} \cdot \bar{b}_2\) que describen a la proyección ortogonal de \(\vec{a}\) sobre dicho plano.
  Sin mayor esfuerzo \(\{\bar{b}_1, \bar{b}_2, \bar{B} = \vec{B} / B\}\) es una base ortonormal de \(\realNumbers^3\).
  Pediremos además que \(\{\bar{b}_1, \bar{b}_2, \bar{B}\}\) esté orientada positivamente.
  Con mayor claridad, lo que pedimos es que se verifiquen las ecuaciones \(\bar{b}_1 \times \bar{b}_2 = \bar{B}\), \(\bar{b}_2 \times \bar{B} = \bar{b}_1\), \(\bar{B} \times \bar{b}_1 = \bar{b}_2\).
  Eso nos ayudará a calcular productos cruz.
  La siguientes propiedades se derivan de esta construcción
  \begin{theorem}
    Las variables \(\alpha\), \(\beta\) nos proveen las identidades
    \begin{align}
      \label{equation:alphaBetaFormulaForAcceleration}
      \vec{a}
      &=
      \alpha \bar{b}_1 + \beta \bar{b}_2 + (\vec{a}_0 \cdot \bar{B}) \bar{B}
      \\
      \label{equation:alphaBetaFormulaForModulusOfAcceleration}
      a_0^2
      &=
      \alpha^2 + \beta^2 + (\vec{a}_0 \cdot \bar{B})^2
      \\
      \label{equation:alphaBetaFormulaForCrossProduct}
      \vec{a} \times \vec{B}
      &=
      B (- \alpha \bar{b}_2 + \beta \bar{b}_1)
      \\
      \label{equation:alphaBetaFormulaForJerk}
      \vec{j}
      &=
      \frac{d \alpha}{d t} \bar{b}_1 + \frac{d \beta}{d t} \bar{b}_2
    \end{align}
  \end{theorem}
  \begin{proof}
    \eqref{equation:alphaBetaFormulaForAcceleration}
    es consecuencia de la ortonormalidad de la base \(\{\bar{b}_1, \bar{b}_2, \bar{B}\}\).
    La fórmula \(\vec{a} \cdot \bar{B} = \vec{a}_0 \cdot \bar{B}\) se debe al teorema \ref{theorem:acceleration_dot_magneticFieldIsConstant}.

    Todas las demás son consecuencia de esta primera ecuación \eqref{equation:alphaBetaFormulaForAcceleration}.

    \eqref{equation:alphaBetaFormulaForModulusOfAcceleration}
    se debe a la ortonormalidad de la base \(\{\bar{b}_1, \bar{b}_2, \bar{B}\}\), y a la igualdad \(a^2 = a_0^2\) que se desprende del teorema teorema \ref{theorem:modulusOfAccelerationIsConstant}.

    \eqref{equation:alphaBetaFormulaForCrossProduct}
    se debe a la orientación positiva de la base \(\{\bar{b}_1, \bar{b}_2, \bar{B}\}\).

    \eqref{equation:alphaBetaFormulaForJerk}
    se debe a la linealidad de la derivada.
  \end{proof}

  \begin{theorem}
    Las funciones \(\alpha\), \(\beta\) satisfacen el sistema de ecuaciones diferenciales
    \begin{align}
      \label{systemOfEquations:alphaBetaSystemOfDifferentialEquations}
      \left\{
        \begin{aligned}
          \frac{d \alpha}{d t} &= \frac{q B}{m} \beta
          \\
          \frac{d \beta}{d t} &= - \frac{q B}{m} \alpha
        \end{aligned}
      \right.
    \end{align}
  \end{theorem}
  \begin{proof}
    Partimos de la ecuación \(m \vec{j} = q \vec{a} \times \vec{B}\).
    Reemplazamos \(\vec{j}\), \(\vec{a} \times \vec{B}\) por sus fórmulas \eqref{equation:alphaBetaFormulaForJerk}, \eqref{equation:alphaBetaFormulaForCrossProduct} en función de \(\alpha\), \(\beta\).
    Obtenemos
    \begin{align}
      \frac{d \alpha}{d t} \bar{b}_1 + \frac{d \beta}{d t} \bar{b}_2
      &=
      \frac{q B}{m} (\beta \bar{b}_1 - \alpha \bar{b}_2)
    \end{align}
    El sistema \eqref{systemOfEquations:alphaBetaSystemOfDifferentialEquations} se deduce usando que \(\bar{b}_1\), \(\bar{b}_2\) son linealmente independientes.
  \end{proof}

  El siguiente caso particular resulta muy interesante.
  Su particularidad es que muestra una familia de trayectorias parabólicas en presencia de un campo magnético nonulo.
  \begin{theorem}
    \label{theorem:initialAccelerationIsParallelToMagneticField}
    Si la aceleración inicial, \(\vec{a}_0\), es paralela al campo magnético, \(\vec{B}\), entonces la aceleración \(\vec{a}\) es constante.
  \end{theorem}
  \begin{proof}
    Partimos de la ecuación \eqref{equation:alphaBetaFormulaForModulusOfAcceleration}, que dice \(
      a_0^2
      =
      \alpha^2 + \beta^2
      + (\vec{a}_0 \cdot \bar{B})^2
    \).
    Si \(\vec{a}_0\) es paralelo a \(\vec{B}\), entonces \(\vec{a}_0 = (\vec{a}_0 \cdot \bar{B}) \bar{B}\) y \(a_0^2 = (\vec{a}_0 \cdot \bar{B})^2\).
    Junto a la primera ecuación, estas implican \(\alpha = \beta = 0\).
    Por la ecuación \eqref{equation:alphaBetaFormulaForAcceleration}, se sigue \(\vec{a} = (\vec{a}_0 \cdot \bar{B}) \bar{B} = \vec{a}_0\)
  \end{proof}

  \begin{theorem}
    Si la aceleración inicial, \(\vec{a}_0\), es paralela al campo magnético, \(\vec{B}\), entonces la solución a la ecuación diferencial \eqref{equation:movementOfChargedParticleExposedToElectromagneticField}
    está dada por
    \begin{align}
      &\vec{r} - \vec{r_0}
      =
      \vec{a}_0 \frac{t^2}{2} + \vec{v}_0 t
      && \text{donde}
      && \vec{a}_0 = \frac{q}{m} \vec{E} + \frac{q}{m} \vec{v}_0 \times \vec{B}
    \end{align}
  \end{theorem}
  \begin{proof}
    Partimos del Teorema \ref{theorem:initialAccelerationIsParallelToMagneticField}.
    La aceleración \(\vec{a}\) es constante.
    Luego \(\vec{v} - \vec{v}_0 = \vec{a}_0 t\).
    Integrar nuevamente arroja \(\vec{r} - \vec{r}_0 = \vec{a}_0 t^2 / 2 + \vec{v}_0 t\).
    La fórmula para \(\vec{a}_0\) se deriva de la identidad \(m \vec{a}_0 = q \vec{E} + q \vec{v}_0 \times \vec{B}\).
  \end{proof}

  En lo que sigue vamos a ignorar este caso, en el cual la velocidad inicial y el campo magnético son paralelos, y supondremos \(\vec{a}_0 \neq (\vec{a}_0 \cdot \bar{B}) \bar{B}\).
  Esto nos permite proyectar el vector \(\vec{a}_0\) sobre el plano ortogonal al campo magnético \(\vec{B}\).
  El resultado es el vector proyección \(\vec{\pi}_0 = \vec{a}_0 - (\vec{a}_0 \cdot \bar{B}) \bar{B}\).
  Que tiene módulo positivo \(\pi_0 = (a_0^2 - (\vec{a}_0 \cdot \bar{B})^2)^{1 / 2}\), y por eso puede ser regularizado \(\bar{\pi}_0 = \vec{\pi}_0 / \pi_0\).
  Este vector es importante, y en el siguiente teorema lo vemos por primera vez.

  \begin{theorem}
    \label{theorem:alphaBetaDescribeCircularMotion}
    Existe un ángulo \(\theta = \theta(t)\) tal que \(\alpha = \pi_0 \cos \theta\), \(\beta = \pi_0 \sin \theta\).
  \end{theorem}
  \begin{proof}
    La ecuación \eqref{equation:alphaBetaFormulaForModulusOfAcceleration} nos dice que \(\pi_0^2 = a_0^2 - (\vec{a}_0 \cdot \bar{B})^2 = \alpha^2 + \beta^2\).
    Se deduce la ecuación de una circunferencia \(\alpha^2 + \beta^2 = \pi_0^2\) de radio \(\pi_0\).
    Luego, para cada tiempo \(t\) existe un ángulo \(\theta = \theta(t)\) tal que \(\alpha = \pi_0 \cos \theta\) y \(\beta = \pi_0 \sin \theta\).
  \end{proof}

  \begin{theorem}
    \label{theorem:thetaDifferentialEquation}
    La velocidad angular \(\omega = \frac{d \theta}{d t}\) es \(\omega = \frac{q B}{m}\).
  \end{theorem}
  \begin{proof}
    Partimos del sistema de ecuaciones diferenciales \eqref{systemOfEquations:alphaBetaSystemOfDifferentialEquations}.
    Reemplazando \(\alpha = \pi_0 \cos \theta\), \(\beta = \pi_0 \sin \theta\), y usando la regla de la cadena, obtenemos
    \begin{align}
      \left\{
        \begin{aligned}
          (\pi_0 \sin \theta) \frac{d \theta}{d t}
          &=
          \frac{q B}{m} (\pi_0 \sin \theta)
          \\
          (- \pi_0 \cos \theta) \frac{d \theta}{d t}
          &=
          \frac{q B}{m} (- \pi_0 \cos \theta)
        \end{aligned}
      \right.
    \end{align}
    Conjuntamente, estas dos ecuaciones implican \(\omega = \frac{q B}{m}\).
  \end{proof}

  En lo que sigue es importante que \(\vec{\pi}_0\) sea nonulo, porque nos permite usarlo para entender los vectores que viven en el plano ortogonal a \(\vec{B}\).

  \begin{theorem}
    \label{theorem:constantsThatDefineTheSolution_b1b2theta0}
    La base \(\{\bar{b}_1, \bar{b}_2\}\) del plano ortogonal a \(\vec{B}\), puede elegirse como
    \begin{align}
      \label{equation:basisVectorsb1b2}
      &\bar{b}_1
      =
      \bar{\pi}_0
      &
      &\bar{b}_2
      =
      \bar{B}
      \times
      \bar{\pi}_0
    \end{align}
    Además, de este modo puede elegirse el valor inicial de \(\theta\) como 
    \begin{align}
      \theta_0 = 0
    \end{align}
  \end{theorem}
  \begin{proof}
    En efecto.
    El vector \(\bar{b}_1 = \bar{\pi}_0\) es unitario y ortogonal a \(\vec{B}\).
    Un buen candidato.
    Por otro lado, el vector \(\bar{b}_2\) queda inmediatamente determinado por la restricción que impusimos sobre la base \(\{\bar{b}_1, \bar{b}_2, \bar{B}\}\) de \(\realNumbers^3\).
    Al especificar que esta tiene que estar orientada positivamente, se verifica \(\bar{B} \times \bar{b}_1 = \bar{b}_2\).
    Y esta última ecuación define a \(\bar{b}_2\).

    Por otro lado, si volvemos a la ecuación \eqref{equation:alphaBetaFormulaForAcceleration}, para el instante \(t = 0\) dice
    \(\vec{a}_0 = \alpha_0 \bar{b}_1 + \beta_0 \bar{b}_2 + (\vec{a}_0 \cdot \bar{B}) \bar{B}\).
    Reemplazando \(\alpha\), \(\beta\) por sus expresiones en función de \(\theta\), obtenemos
    \begin{align}
      \vec{a}_0
      =
      \pi_0 \cos \theta_0 \bar{b}_1
      + \pi_0 \sin \theta_0 \bar{b}_2
      + (\vec{a}_0 \cdot \bar{B}) \bar{B}
    \end{align}
    Pero \(\vec{\pi}_0 = \vec{a}_0 - (\vec{a}_0 \cdot \bar{B}) \bar{B}\).
    Entonces
    \(
      \bar{\pi}_0
      =
      \cos \theta_0 \bar{b}_1
      + \sin \theta_0 \bar{b}_2
    \)
    .
    Aquí se aprecia que \(\theta_0 = 0\) es una elección viable para el ángulo inicial.
  \end{proof}

  \begin{theorem}
    \label{theorem:thetaSolution}
    El ángulo es \(\theta = \omega t\).
  \end{theorem}
  \begin{proof}
    Es una consecuencia trivial de \ref{theorem:thetaDifferentialEquation} y \ref{theorem:constantsThatDefineTheSolution_b1b2theta0}.
  \end{proof}

  \begin{theorem}
    La solución \(\vec{v}\) a la ecuación \(m \vec{j} = q \vec{a} \times \vec{B}\), donde el campo magnético es constante, está dada por
    \begin{align}
      \vec{v} - \vec{v}_0
      =
      \frac{\sin \omega t}{\omega}
      \vec{\pi}_0
      - \frac{\cos \omega t}{\omega}
      \bar{B}
      \times
      \vec{\pi}_0
      + (\vec{a}_0 \cdot \bar{B}) \bar{B} t
    \end{align}
  \end{theorem}
  \begin{proof}
    Partimos de la ecuación \eqref{equation:alphaBetaFormulaForAcceleration}
    \begin{align}
      \vec{a}
      &=
      \alpha \bar{b}_1 + \beta \bar{b}_2 + (\vec{a}_0 \cdot \bar{B}) \bar{B}
    \end{align}
    Reemplazamos \(\bar{b}_1\), \(\bar{b}_2\) por los vectores que propusimos en \ref{theorem:constantsThatDefineTheSolution_b1b2theta0}
    \begin{align}
      \vec{a}
      &=
      \alpha \bar{\pi} + \beta \bar{B} \times \bar{\pi} + (\vec{a}_0 \cdot \bar{B}) \bar{B}
    \end{align}
    Reemplazamos \(\alpha\), \(\beta\) por las expresiones en función de \(\theta\) que obtuvimos en \ref{theorem:alphaBetaDescribeCircularMotion}
    \begin{align}
      \vec{a}
      &=
      (\pi_0 \cos \theta) \bar{\pi}_0 + (\pi_0 \sin \theta) \bar{B} \times \bar{\pi}_0 + (\vec{a}_0 \cdot \bar{B}) \bar{B}
      \\
      &=
      (\cos \theta) \vec{\pi}_0 + (\sin \theta) \bar{B} \times \vec{\pi}_0 + (\vec{a}_0 \cdot \bar{B}) \bar{B}
    \end{align}
    Reemplazamos \(\theta\) por \(\omega t\), usando el teorema \ref{theorem:thetaSolution}
    \begin{align}
      \vec{a}
      &=
      (\cos \omega t) \vec{\pi}_0
      + (\sin \omega t) \bar{B} \times \vec{\pi}_0
      + (\vec{a}_0 \cdot \bar{B}) \bar{B}
    \end{align}
    Integrando con respecto a \(t\) obtenemos el resultado que deseamos. 
  \end{proof}

  \begin{theorem}
    La solución \(\vec{r}\) a la ecuación \(m \vec{a} = q \vec{E} + q \vec{v} \times \vec{B}\), donde el campo eléctrico \(\vec{E}\) y el campo magnético \(\vec{B}\) son constantes, es
    \begin{align}
      \vec{r} - \vec{r}_0
      &=
      - \frac{(\cos \omega t) \vec{\pi}_0 + (\sen \omega t) \bar{B} \times \vec{\pi}_0}{\omega^2}
      + (\vec{a}_0 \cdot \bar{B}) \bar{B} \frac{t^2}{2}
      + \vec{v_0} t
    \end{align}
    Donde
    \begin{align}
      \vec{\pi}_0
      &=
      \vec{a}_0 - (\vec{a}_0 \cdot \bar{B}) \bar{B}
      \\
      \vec{a}_0
      &=
      \frac{q}{m} \vec{E} + \frac{q}{m} \vec{v}_0 \times \vec{B}
      \\
      \bar{B}
      &=
      \vec{B} / B
    \end{align}
  \end{theorem}

  Observar que esta última fórmula también funciona en el caso en que \(\vec{a}_0\) sea paralelo a \(\vec{B}\).
  Allí, sencillamente \(\vec{\pi}_0 = 0\).
\end{document}
